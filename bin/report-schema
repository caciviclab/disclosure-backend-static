#!/bin/bash
# Usage: ./bin/report-schema [database name]
#        ./bin/report-schema disclosure-backend
set -e

if [ $# -ne 1 ]; then
  echo 'Usage: ./bin/report-schema [database name]'
  exit 1
fi

DATABASE_NAME=$1

FIRST_COPY_LINE="$(pg_dump ${DATABASE_NAME} | grep 'COPY' | head -n 1)"
pg_dump $DATABASE_NAME | grep -i -B 5000 "$FIRST_COPY_LINE" | head -n -5 > build/schema.sql

